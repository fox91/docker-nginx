#!/bin/bash
set -e
set -u

DH=/etc/nginx/certs/dhparam.pem
DH_SIZE=2048
KEY=/etc/nginx/certs/localhost.key
CERT=/etc/nginx/certs/localhost.crt

openssl dhparam -out "$DH" $DH_SIZE
openssl req -x509 -newkey rsa:4086 \
  -subj "/C=XX/ST=XXXX/L=XXXX/O=XXXX/CN=localhost" \
  -keyout $KEY \
  -out $CERT \
  -days 3650 -nodes -sha256

chmod 400 $KEY
